# é‚®ä»¶å‘é€APIç³»ç»Ÿ

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å¤šç§Ÿæˆ·é‚®ä»¶å‘é€ç³»ç»Ÿï¼ŒåŸºäºFastAPIæ„å»ºï¼Œæ”¯æŒé™„ä»¶ä¸Šä¼ ã€SMTPé…ç½®ç®¡ç†ã€é‚®ä»¶é˜Ÿåˆ—ã€å‘é€çŠ¶æ€è·Ÿè¸ªç­‰å®Œæ•´åŠŸèƒ½ã€‚

## ğŸ“‹ ç›®å½•

- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [APIæ–‡æ¡£](#apiæ–‡æ¡£)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
- [è®¸å¯è¯](#è®¸å¯è¯)

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸš€ æ ¸å¿ƒåŠŸèƒ½

- **å¤šç§Ÿæˆ·æ”¯æŒ** - å®Œæ•´çš„ç§Ÿæˆ·éš”ç¦»æœºåˆ¶
- **SMTPé…ç½®ç®¡ç†** - æ”¯æŒå¤šç§SMTPæœåŠ¡å•†ï¼Œå¯†ç åŠ å¯†å­˜å‚¨
- **å•å‘/ç¾¤å‘é‚®ä»¶** - æ”¯æŒå•ä¸ªæ”¶ä»¶äººå’Œæ‰¹é‡å‘é€
- **é™„ä»¶æ”¯æŒ** - å®Œæ•´çš„æ–‡ä»¶ä¸Šä¼ ã€éªŒè¯ã€å­˜å‚¨å’Œå‘é€åŠŸèƒ½
- **é‚®ä»¶é˜Ÿåˆ—** - å¼‚æ­¥é‚®ä»¶å‘é€é˜Ÿåˆ—ï¼Œæ”¯æŒä¼˜å…ˆçº§å’Œé‡è¯•
- **å‘é€çŠ¶æ€è·Ÿè¸ª** - å®æ—¶è·Ÿè¸ªé‚®ä»¶å‘é€çŠ¶æ€å’Œæ—¥å¿—

### ğŸ”’ å®‰å…¨ç‰¹æ€§

- **å¯†ç åŠ å¯†** - ä½¿ç”¨FernetåŠ å¯†ç®—æ³•ä¿æŠ¤SMTPå¯†ç 
- **æ–‡ä»¶éªŒè¯** - å¤šå±‚æ–‡ä»¶å®‰å…¨éªŒè¯ï¼Œé˜²æ­¢æ¶æ„æ–‡ä»¶ä¸Šä¼ 
- **è®¿é—®æ§åˆ¶** - åŸºäºç§Ÿæˆ·çš„æ•°æ®éš”ç¦»
- **å®‰å…¨å¤´éƒ¨** - å®Œæ•´çš„HTTPå®‰å…¨å¤´éƒ¨é…ç½®
- **é€Ÿç‡é™åˆ¶** - APIè¯·æ±‚é€Ÿç‡é™åˆ¶å’Œé˜²æŠ¤

### ğŸ“Š ç®¡ç†åŠŸèƒ½

- **é‚®ä»¶æ¨¡æ¿** - æ”¯æŒåŠ¨æ€é‚®ä»¶æ¨¡æ¿å’Œå˜é‡æ›¿æ¢
- **ç»Ÿè®¡æŠ¥å‘Š** - å‘é€æˆåŠŸç‡ã€å¤±è´¥ç»Ÿè®¡ç­‰åˆ†æ
- **æ—¥å¿—å®¡è®¡** - å®Œæ•´çš„æ“ä½œæ—¥å¿—å’Œé‚®ä»¶å‘é€è®°å½•
- **å¥åº·ç›‘æ§** - ç³»ç»Ÿå¥åº·æ£€æŸ¥å’Œæ€§èƒ½ç›‘æ§

### ğŸ›  æŠ€æœ¯ç‰¹æ€§

- **å¼‚æ­¥å¤„ç†** - åŸºäºasyncioçš„é«˜æ€§èƒ½å¼‚æ­¥å¤„ç†
- **æ•°æ®åº“æ”¯æŒ** - æ”¯æŒPostgreSQLå’ŒSQLite
- **ç¼“å­˜æœºåˆ¶** - Redisç¼“å­˜æå‡æ€§èƒ½
- **å®¹å™¨åŒ–** - å®Œæ•´çš„Dockeræ”¯æŒ
- **å¯æ‰©å±•æ€§** - å¾®æœåŠ¡æ¶æ„ï¼Œæ˜“äºæ‰©å±•

## ğŸ— ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯åº”ç”¨      â”‚    â”‚   ç§»åŠ¨åº”ç”¨      â”‚    â”‚   ç¬¬ä¸‰æ–¹ç³»ç»Ÿ    â”‚
â”‚  (React/Vue)    â”‚    â”‚ (React Native)  â”‚    â”‚     (API)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Nginx/LB      â”‚  â† è´Ÿè½½å‡è¡¡
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   FastAPI       â”‚  â† ä¸»åº”ç”¨
                    â”‚   (Email API)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚               â”‚               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   PostgreSQL    â”‚ â”‚     Redis       â”‚ â”‚   æ–‡ä»¶å­˜å‚¨      â”‚
    â”‚   (æ•°æ®åº“)      â”‚ â”‚   (ç¼“å­˜/é˜Ÿåˆ—)   â”‚ â”‚  (é™„ä»¶å­˜å‚¨)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Python 3.11+
- PostgreSQL 13+ æˆ– SQLite
- Redis 6+ (å¯é€‰)
- Docker & Docker Compose (æ¨è)

### 2. ä½¿ç”¨Dockerå¿«é€Ÿéƒ¨ç½²

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/email-api.git
cd email-api

# å¤åˆ¶ç¯å¢ƒå˜é‡é…ç½®
cp .env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆå¿…é¡»ä¿®æ”¹æ•°æ®åº“å¯†ç å’Œå¯†é’¥ï¼‰
vim .env

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f email-api
```

### 3. æœ¬åœ°å¼€å‘ç¯å¢ƒ

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/email-api.git
cd email-api

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ– venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶

# å¯åŠ¨æ•°æ®åº“ï¼ˆä½¿ç”¨Dockerï¼‰
docker run -d \
  --name email_api_db \
  -e POSTGRES_DB=email_api_db \
  -e POSTGRES_USER=emailapi \
  -e POSTGRES_PASSWORD=emailapi123 \
  -p 5432:5432 \
  postgres:15-alpine

# å¯åŠ¨åº”ç”¨
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 4. éªŒè¯å®‰è£…

è®¿é—®ä»¥ä¸‹URLéªŒè¯ç³»ç»Ÿè¿è¡ŒçŠ¶æ€ï¼š

- APIæ–‡æ¡£: http://localhost:8000/docs
- å¥åº·æ£€æŸ¥: http://localhost:8000/health
- ç³»ç»Ÿä¿¡æ¯: http://localhost:8000/info

## ğŸ“š APIæ–‡æ¡£

### ä¸»è¦APIç«¯ç‚¹

#### SMTPé…ç½®ç®¡ç†

```http
# åˆ›å»ºSMTPé…ç½®
POST /api/v1/email/smtp-settings
Content-Type: application/json

{
    "tenant_id": "uuid",
    "setting_name": "Gmail SMTP",
    "smtp_host": "smtp.gmail.com",
    "smtp_port": 587,
    "smtp_username": "your-email@gmail.com",
    "smtp_password": "your-app-password",
    "security_protocol": "TLS",
    "from_email": "your-email@gmail.com",
    "from_name": "å‘é€è€…åç§°",
    "is_default": true
}

# è·å–SMTPé…ç½®åˆ—è¡¨
GET /api/v1/email/smtp-settings/{tenant_id}

# æµ‹è¯•SMTPè¿æ¥
POST /api/v1/email/smtp-settings/test
```

#### é™„ä»¶ç®¡ç†

```http
# ä¸Šä¼ å•ä¸ªé™„ä»¶
POST /api/v1/email/attachments/upload
Content-Type: multipart/form-data

tenant_id: uuid
file: [binary]

# æ‰¹é‡ä¸Šä¼ é™„ä»¶
POST /api/v1/email/attachments/upload-multiple
Content-Type: multipart/form-data

tenant_id: uuid
files: [binary array]

# åˆ é™¤é™„ä»¶
DELETE /api/v1/email/attachments/{tenant_id}/{attachment_id}?filename=file.pdf
```

#### é‚®ä»¶å‘é€

```http
# å‘é€æ™®é€šé‚®ä»¶
POST /api/v1/email/send
Content-Type: application/json

{
    "tenant_id": "uuid",
    "to_emails": ["recipient@example.com"],
    "subject": "é‚®ä»¶ä¸»é¢˜",
    "body_text": "çº¯æ–‡æœ¬å†…å®¹",
    "body_html": "<p>HTMLå†…å®¹</p>",
    "priority": 5
}

# å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶
POST /api/v1/email/send-with-attachments
Content-Type: application/json

{
    "tenant_id": "uuid",
    "to_emails": ["recipient@example.com"],
    "subject": "å¸¦é™„ä»¶çš„é‚®ä»¶",
    "body_text": "é‚®ä»¶å†…å®¹",
    "attachment_ids": ["attachment-uuid-1", "attachment-uuid-2"]
}

# æ‰¹é‡å‘é€é‚®ä»¶
POST /api/v1/email/send-bulk
```

#### çŠ¶æ€æŸ¥è¯¢

```http
# æŸ¥è¯¢é‚®ä»¶çŠ¶æ€
GET /api/v1/email/queue/{tenant_id}/{queue_id}

# è·å–é‚®ä»¶é˜Ÿåˆ—åˆ—è¡¨
GET /api/v1/email/queue/{tenant_id}?limit=50&offset=0

# è·å–å‘é€ç»Ÿè®¡
GET /api/v1/email/statistics/{tenant_id}?days=30
```

### å®Œæ•´APIæ–‡æ¡£

å¯åŠ¨æœåŠ¡åè®¿é—® http://localhost:8000/docs æŸ¥çœ‹å®Œæ•´çš„äº¤äº’å¼APIæ–‡æ¡£ã€‚

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®

ä¸»è¦é…ç½®é¡¹è¯´æ˜ï¼š

```bash
# æ•°æ®åº“é…ç½®
DATABASE_URL="postgresql://user:pass@host:5432/dbname"

# å®‰å…¨é…ç½®
SECRET_KEY="your-secret-key"  # JWTç­¾åå¯†é’¥
ENCRYPTION_KEY="your-fernet-key"  # SMTPå¯†ç åŠ å¯†å¯†é’¥

# æ–‡ä»¶ä¸Šä¼ é™åˆ¶
MAX_FILE_SIZE=26214400  # 25MB
MAX_FILES_PER_REQUEST=10
MAX_TOTAL_REQUEST_SIZE=104857600  # 100MB

# é‚®ä»¶å‘é€é™åˆ¶
MAX_RECIPIENTS_PER_EMAIL=100
MAX_BULK_EMAILS=1000
EMAIL_TIMEOUT_SECONDS=60

# å‰ç«¯CORSé…ç½®
BACKEND_CORS_ORIGINS='["http://localhost:3000","https://yourdomain.com"]'
```

### SMTPæœåŠ¡å•†é…ç½®ç¤ºä¾‹

#### Gmailé…ç½®

```json
{
    "smtp_host": "smtp.gmail.com",
    "smtp_port": 587,
    "smtp_username": "your-email@gmail.com",
    "smtp_password": "your-app-password",  // éœ€è¦å¼€å¯2FAå¹¶ç”Ÿæˆåº”ç”¨å¯†ç 
    "security_protocol": "TLS"
}
```

#### Outlooké…ç½®

```json
{
    "smtp_host": "smtp-mail.outlook.com",
    "smtp_port": 587,
    "smtp_username": "your-email@outlook.com",
    "smtp_password": "your-password",
    "security_protocol": "TLS"
}
```

#### ä¼ä¸šé‚®ç®±é…ç½®

```json
{
    "smtp_host": "smtp.exmail.qq.com",  // è…¾è®¯ä¼ä¸šé‚®ç®±
    "smtp_port": 587,
    "smtp_username": "your-email@yourdomain.com",
    "smtp_password": "your-password",
    "security_protocol": "TLS"
}
```

## ğŸš€ éƒ¨ç½²æŒ‡å—

### Dockeréƒ¨ç½²ï¼ˆæ¨èï¼‰

#### 1. åŸºç¡€éƒ¨ç½²

```bash
# å…‹éš†ä»£ç 
git clone https://github.com/yourusername/email-api.git
cd email-api

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
vim .env  # ä¿®æ”¹å¿…è¦çš„é…ç½®

# æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose ps
docker-compose logs -f
```

#### 2. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

```bash
# ä½¿ç”¨ç”Ÿäº§é…ç½®
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d

# åŒ…å«æ‰€æœ‰æœåŠ¡ï¼ˆé˜Ÿåˆ—ã€ç›‘æ§ç­‰ï¼‰
docker-compose --profile production --profile queue --profile monitoring up -d
```

#### 3. æ‰©å®¹éƒ¨ç½²

```bash
# æ°´å¹³æ‰©å±•APIæœåŠ¡
docker-compose up -d --scale email-api=3

# ä½¿ç”¨è´Ÿè½½å‡è¡¡
docker-compose --profile production up -d
```

### æ‰‹åŠ¨éƒ¨ç½²

#### 1. ç³»ç»Ÿå‡†å¤‡

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install python3.11 python3.11-venv postgresql redis-server nginx

# CentOS/RHEL
sudo yum install python3.11 postgresql-server redis nginx
```

#### 2. åº”ç”¨éƒ¨ç½²

```bash
# åˆ›å»ºç”¨æˆ·
sudo useradd -m -s /bin/bash emailapi

# éƒ¨ç½²ä»£ç 
sudo -u emailapi git clone https://github.com/yourusername/email-api.git /home/emailapi/app
cd /home/emailapi/app

# å®‰è£…ä¾èµ–
sudo -u emailapi python3.11 -m venv venv
sudo -u emailapi venv/bin/pip install -r requirements.txt

# é…ç½®ç¯å¢ƒå˜é‡
sudo -u emailapi cp .env.example .env
sudo -u emailapi vim .env

# é…ç½®systemdæœåŠ¡
sudo cp deployment/email-api.service /etc/systemd/system/
sudo systemctl enable email-api
sudo systemctl start email-api
```

#### 3. Nginxé…ç½®

```nginx
# /etc/nginx/sites-available/email-api
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    
    location /uploads/ {
        alias /home/emailapi/app/uploads/;
        expires 1d;
    }
}
```

### äº‘å¹³å°éƒ¨ç½²

#### AWS ECSéƒ¨ç½²

```bash
# æ„å»ºå¹¶æ¨é€é•œåƒåˆ°ECR
aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin 123456789.dkr.ecr.us-east-1.amazonaws.com
docker build -t email-api .
docker tag email-api:latest 123456789.dkr.ecr.us-east-1.amazonaws.com/email-api:latest
docker push 123456789.dkr.ecr.us-east-1.amazonaws.com/email-api:latest

# ä½¿ç”¨æä¾›çš„ECSä»»åŠ¡å®šä¹‰æ–‡ä»¶
aws ecs register-task-definition --cli-input-json file://deployment/ecs-task-definition.json
```

#### Kuberneteséƒ¨ç½²

```bash
# åº”ç”¨Kubernetesé…ç½®
kubectl apply -f deployment/k8s/

# æ£€æŸ¥éƒ¨ç½²çŠ¶æ€
kubectl get pods -l app=email-api
kubectl get services
```

## ğŸ‘¨â€ğŸ’» å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
email_api/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                 # FastAPIåº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ config.py               # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ database.py             # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ email_models.py     # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ email_schemas.py    # è¯·æ±‚/å“åº”æ¨¡å‹
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ email_service.py    # é‚®ä»¶ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ smtp_service.py     # SMTPæœåŠ¡
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ email_routes.py     # APIè·¯ç”±
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ security.py         # å®‰å…¨å·¥å…·
â”œâ”€â”€ tests/                      # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ deployment/                 # éƒ¨ç½²é…ç½®
â”œâ”€â”€ docs/                       # æ–‡æ¡£
â”œâ”€â”€ requirements.txt            # Pythonä¾èµ–
â”œâ”€â”€ docker-compose.yml          # Dockerç¼–æ’
â”œâ”€â”€ Dockerfile                  # Dockeræ„å»º
â””â”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
```

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements-dev.txt

# ä»£ç æ ¼å¼åŒ–
black app/
isort app/

# ç±»å‹æ£€æŸ¥
mypy app/

# è¿è¡Œæµ‹è¯•
pytest

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=app --cov-report=html
```

### æ·»åŠ æ–°åŠŸèƒ½

1. **æ•°æ®æ¨¡å‹** - åœ¨ `models/` ä¸­å®šä¹‰SQLAlchemyæ¨¡å‹
2. **è¯·æ±‚æ¨¡å‹** - åœ¨ `schemas/` ä¸­å®šä¹‰Pydanticæ¨¡å‹
3. **ä¸šåŠ¡é€»è¾‘** - åœ¨ `services/` ä¸­å®ç°ä¸šåŠ¡é€»è¾‘
4. **APIè·¯ç”±** - åœ¨ `api/` ä¸­æ·»åŠ FastAPIè·¯ç”±
5. **æµ‹è¯•** - åœ¨ `tests/` ä¸­æ·»åŠ æµ‹è¯•ç”¨ä¾‹

### æ•°æ®åº“è¿ç§»

```bash
# ç”Ÿæˆè¿ç§»æ–‡ä»¶
alembic revision --autogenerate -m "Add new feature"

# åº”ç”¨è¿ç§»
alembic upgrade head

# å›æ»šè¿ç§»
alembic downgrade -1
```

### æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•
pytest tests/test_email_service.py

# è¿è¡Œå¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=app

# æ€§èƒ½æµ‹è¯•
pytest tests/performance/
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. SMTPè¿æ¥å¤±è´¥

**é—®é¢˜**: SMTPè¿æ¥æµ‹è¯•å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥SMTPæœåŠ¡å™¨åœ°å€å’Œç«¯å£
- éªŒè¯ç”¨æˆ·åå’Œå¯†ç 
- ç¡®è®¤å®‰å…¨åè®®è®¾ç½®ï¼ˆTLS/SSLï¼‰
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
- å¯¹äºGmailï¼Œç¡®ä¿ä½¿ç”¨åº”ç”¨å¯†ç 

```bash
# æµ‹è¯•SMTPè¿æ¥
curl -X POST "http://localhost:8000/api/v1/email/smtp-settings/test" \
  -H "Content-Type: application/json" \
  -d '{
    "tenant_id": "your-tenant-id",
    "smtp_setting_id": "your-smtp-setting-id"
  }'
```

#### 2. æ–‡ä»¶ä¸Šä¼ å¤±è´¥

**é—®é¢˜**: é™„ä»¶ä¸Šä¼ å¤±è´¥æˆ–æ–‡ä»¶è¿‡å¤§

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥æ–‡ä»¶å¤§å°æ˜¯å¦è¶…è¿‡é™åˆ¶ï¼ˆé»˜è®¤25MBï¼‰
- éªŒè¯æ–‡ä»¶ç±»å‹æ˜¯å¦åœ¨å…è®¸åˆ—è¡¨ä¸­
- æ£€æŸ¥ç£ç›˜ç©ºé—´
- ç¡®è®¤ä¸Šä¼ ç›®å½•æƒé™

```bash
# æ£€æŸ¥ä¸Šä¼ ç›®å½•
ls -la uploads/attachments/
df -h  # æ£€æŸ¥ç£ç›˜ç©ºé—´
```

#### 3. æ•°æ®åº“è¿æ¥é—®é¢˜

**é—®é¢˜**: æ— æ³•è¿æ¥åˆ°æ•°æ®åº“

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥æ•°æ®åº“æœåŠ¡æ˜¯å¦è¿è¡Œ
- éªŒè¯è¿æ¥å­—ç¬¦ä¸²æ ¼å¼
- æ£€æŸ¥æ•°æ®åº“ç”¨æˆ·æƒé™
- ç¡®è®¤ç½‘ç»œè¿æ¥

```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
psql "postgresql://user:pass@host:5432/dbname"

# æ£€æŸ¥æ•°æ®åº“æœåŠ¡çŠ¶æ€
sudo systemctl status postgresql
```

#### 4. é‚®ä»¶å‘é€è¶…æ—¶

**é—®é¢˜**: é‚®ä»¶å‘é€è¶…æ—¶æˆ–å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
- å¢åŠ è¶…æ—¶æ—¶é—´è®¾ç½®
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- éªŒè¯SMTPæœåŠ¡å™¨çŠ¶æ€
- æ£€æŸ¥é‚®ä»¶å†…å®¹å¤§å°

#### 5. æ€§èƒ½é—®é¢˜

**é—®é¢˜**: APIå“åº”æ…¢æˆ–è¶…æ—¶

**è§£å†³æ–¹æ¡ˆ**:
- å¯ç”¨Redisç¼“å­˜
- ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
- å¢åŠ å·¥ä½œè¿›ç¨‹æ•°
- ä½¿ç”¨CDNåŠ é€Ÿé™æ€æ–‡ä»¶

### æ—¥å¿—åˆ†æ

```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker-compose logs -f email-api

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep "ERROR" logs/app.log

# æŸ¥çœ‹SMTPç›¸å…³æ—¥å¿—
grep "SMTP" logs/app.log

# å®æ—¶ç›‘æ§æ—¥å¿—
tail -f logs/app.log | grep -E "(ERROR|WARNING)"
```

### ç›‘æ§å’Œå‘Šè­¦

```bash
# æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
curl http://localhost:8000/health

# æ£€æŸ¥é‚®ä»¶é˜Ÿåˆ—çŠ¶æ€
curl http://localhost:8000/api/v1/email/queue/{tenant_id}

# æ£€æŸ¥ç»Ÿè®¡ä¿¡æ¯
curl http://localhost:8000/api/v1/email/statistics/{tenant_id}
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. å¼€å¯Pull Request

### ä»£ç è§„èŒƒ

- ä½¿ç”¨Blackè¿›è¡Œä»£ç æ ¼å¼åŒ–
- éµå¾ªPEP 8è§„èŒƒ
- æ·»åŠ ç±»å‹æ³¨è§£
- ç¼–å†™å•å…ƒæµ‹è¯•
- æ›´æ–°æ–‡æ¡£

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯å¼€æºã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ“ æ”¯æŒä¸è”ç³»

- ğŸ“§ é‚®ç®±: support@email-api.com
- ğŸ“– æ–‡æ¡£: https://docs.email-api.com
- ğŸ› é—®é¢˜æŠ¥å‘Š: https://github.com/yourusername/email-api/issues
- ğŸ’¬ è®¨è®º: https://github.com/yourusername/email-api/discussions

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [FastAPI](https://fastapi.tiangolo.com/) - ç°ä»£é«˜æ€§èƒ½Webæ¡†æ¶
- [SQLAlchemy](https://www.sqlalchemy.org/) - Python SQLå·¥å…·åŒ…
- [Pydantic](https://pydantic-docs.helpmanual.io/) - æ•°æ®éªŒè¯åº“
- [aiosmtplib](https://aiosmtplib.readthedocs.io/) - å¼‚æ­¥SMTPå®¢æˆ·ç«¯
- [Cryptography](https://cryptography.io/) - åŠ å¯†åº“

---

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª â­ï¸ Starï¼**